<div class="bg-white shadow rounded-lg mb-6 overflow-hidden">
  <div class="px-6 py-4 border-b border-gray-200 bg-gray-50 flex justify-between items-center">
    <h3 class="text-lg leading-6 font-medium text-gray-900">Budget Planner</h3>
    <div class="text-sm text-gray-500">
      Avg Wage: <%= number_to_currency(@budget_data[:average_hourly_rate]) %>/hr
    </div>
  </div>
  
  <div class="p-6">
    <div class="grid grid-cols-1 md:grid-cols-5 gap-4 mb-6">
      
      <!-- Input: Weekly Sales -->
      <div class="p-4 bg-blue-50 rounded-lg border border-blue-100">
        <label class="block text-xs font-medium text-blue-700 uppercase tracking-wider">Projected Sales</label>
        <div class="mt-2 text-2xl font-bold text-blue-900">
          <%= number_to_currency(@budget_data[:sales_forecast], precision: 0) %>
        </div>
      </div>

      <!-- Input: Target % (Editable) -->
      <%= form_with model: @roster, url: roster_path(@roster), method: :patch, class: "p-4 bg-gray-50 rounded-lg border border-gray-200", data: { turbo: false } do |f| %>
        <label class="block text-xs font-medium text-gray-500 uppercase tracking-wider mb-2">Target Wage %</label>
        <div class="flex items-center gap-2">
          <%= f.number_field :target_wage_percentage, value: @budget_data[:target_percentage], min: 1, max: 100, step: 0.1, class: "w-20 px-2 py-1 text-2xl font-bold text-gray-900 border border-gray-300 rounded focus:ring-blue-500 focus:border-blue-500" %>
          <span class="text-2xl font-bold text-gray-900">%</span>
          <%= f.submit "Update", class: "ml-2 px-3 py-1 text-xs bg-blue-600 text-white rounded hover:bg-blue-700" %>
        </div>
      <% end %>

      <!-- Calc: Total Budget -->
      <div class="p-4 bg-green-50 rounded-lg border border-green-100">
        <label class="block text-xs font-medium text-green-700 uppercase tracking-wider">Total Wage Budget</label>
        <div class="mt-2 text-2xl font-bold text-green-900">
          <%= number_to_currency(@budget_data[:total_budget], precision: 0) %>
        </div>
      </div>

      <!-- Calc: Actual Cost -->
      <div class="p-4 <%= @budget_data[:total_variance] >= 0 ? 'bg-white' : 'bg-red-50' %> rounded-lg border <%= @budget_data[:total_variance] >= 0 ? 'border-gray-200' : 'border-red-100' %>">
        <label class="block text-xs font-medium text-gray-500 uppercase tracking-wider">Actual Cost</label>
        <div class="mt-2 text-2xl font-bold text-gray-900">
          <%= number_to_currency(@budget_data[:total_actual], precision: 0) %>
        </div>
        <div class="text-xs mt-1 text-gray-500"><%= @budget_data[:daily_breakdown].sum { |d| d[:hours] } %> hrs</div>
      </div>

      <!-- Calc: Variance -->
      <div class="p-4 <%= @budget_data[:total_variance] >= 0 ? 'bg-green-100' : 'bg-red-100' %> rounded-lg border <%= @budget_data[:total_variance] >= 0 ? 'border-green-200' : 'border-red-200' %>">
        <label class="block text-xs font-medium <%= @budget_data[:total_variance] >= 0 ? 'text-green-800' : 'text-red-800' %> uppercase tracking-wider">Variance</label>
        <div class="mt-2 text-2xl font-bold <%= @budget_data[:total_variance] >= 0 ? 'text-green-900' : 'text-red-900' %>">
          <%= number_to_currency(@budget_data[:total_variance], precision: 0) %>
        </div>
      </div>
    </div>

    <!-- Section Breakdown Accordion (Simplified as list for now) -->
    <div class="border-t border-gray-100 pt-4">
      <h4 class="text-xs font-semibold text-gray-500 uppercase tracking-wider mb-3">Wages by Section</h4>
      <div class="grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-2">
        <% @budget_data[:section_breakdown].each do |section| %>
          <div class="text-sm border border-gray-100 rounded p-2">
            <div class="font-medium text-gray-900"><%= section[:name] %></div>
            <div class="flex justify-between items-baseline mt-1">
              <span class="text-gray-500 text-xs"><%= section[:hours] %>h</span>
              <span class="text-gray-900 font-semibold"><%= number_to_currency(section[:cost], precision: 0) %></span>
            </div>
          </div>
        <% end %>
      </div>
    </div>
  </div>
</div>
